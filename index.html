<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kaming Lee</title>
  <link rel="stylesheet" href="index.css" />
</head>

<body>
  <!-- STAGE: ALWAYS FULL VIEWPORT -->
  <div id="stage">
    <img id="slide" alt="" draggable="false" />

    <!-- FIXED EMAIL -->
    <a href="mailto:karning.lee@gmail.com" class="site-email">
      karning.lee@gmail.com
    </a>

    <!-- CLICK ZONES -->
    <div class="nav-zone nav-left" aria-hidden="true"></div>
    <div class="nav-zone nav-right" aria-hidden="true"></div>
  </div>

  <script>
    const slides = [
      { desktop: 'assets/img/onesec.gif?v=4', mobile: 'assets/img/onesec_mobile.gif?v=4' },
      { desktop: 'assets/img/stirfry1.jpg' },
      { desktop: 'assets/img/stirfry2.jpg' },
      { desktop: 'assets/img/stirfry3.jpg' },
      { desktop: 'assets/img/stirfry10.jpg' },
      { desktop: 'assets/img/stirfry5.jpg' },
      // { desktop: 'assets/img/stirfry6.jpg', mobile: 'assets/img/stirfry6_mobile.jpg' },
      { desktop: 'assets/img/stirfry7.jpg' },
      { desktop: 'assets/img/stirfry8.jpg' },
      // { desktop: 'assets/img/stirfry9.gif' }
    ];

    let index = 0;

    function isMobile() {
      return window.matchMedia('(max-width: 768px)').matches;
    }

    function setSlide(i) {
      const s = slides[i];
      const src = (isMobile() && s.mobile) ? s.mobile : s.desktop;
      const img = document.getElementById('slide');
      img.src = src;
    }

    function nextSlide() {
      index = (index + 1) % slides.length;
      setSlide(index);
    }

    function prevSlide() {
      index = (index - 1 + slides.length) % slides.length;
      setSlide(index);
    }

    // init
    setSlide(index);

    // click zones
    document.querySelector('.nav-left').addEventListener('click', prevSlide);
    document.querySelector('.nav-right').addEventListener('click', nextSlide);

    // keyboard
    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') nextSlide();
      if (e.key === 'ArrowLeft') prevSlide();
    });

    // resize: force repaint reliably
    let resizeTimer = null;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(() => setSlide(index), 50);
    });

    // touch swipe
    let touchStartX = null;
    window.addEventListener('touchstart', (e) => {
      if (e.touches.length !== 1) return;
      touchStartX = e.touches[0].clientX;
    }, { passive: true });

    window.addEventListener('touchend', (e) => {
      if (touchStartX === null) return;
      const dx = e.changedTouches[0].clientX - touchStartX;
      if (dx > 50) prevSlide();
      if (dx < -50) nextSlide();
      touchStartX = null;
    }, { passive: true });

    // discourage casual download
    document.addEventListener('contextmenu', (e) => e.preventDefault());
    document.addEventListener('dragstart', (e) => e.preventDefault());
  </script>
</body>
</html>
